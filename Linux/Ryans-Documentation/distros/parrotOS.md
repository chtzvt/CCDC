# ParrotOS

### Updates

You may (or may not) need to add these two sources to `/etc/apt/sources.list`:
```
deb http://mirrors.mit.edu/parrot/ parrot main contrib non-free
deb http://deb.parrotsec.org/parrot stable main contrib non-free
```

then you can just update like normal:
```
$	sudo apt-get update
```

remember, in order to do this, you will need DNS (name resolution of sources), and HTTP (downloading of packages occurs over http)

### Access Control

To change the password:
```
$	passwd
```

To add the user `michael`:
```
$	sudo adduser michael
```

To delete the user `michael`:
```
$	sudo deluser michael
```

To add the user `michael` to the group `sudo`:
```
$	sudo usermod -aG sudo michael
```

to remove the user `michael` from the group `sudo`:
```
$	sudo gpasswd -d michael sudp
```

to view all users with sudo privileges:
```
$	cat /etc/group | grep sudo
$	cat /etc/group | grep root
```

### SSH

#### Install & Daemon

to install OpenSSH-Server:
```
$	sudo apt-get update
$	sudo apt-get install openssh-server
```

to start and enable the ssh daemon:
```
$	sudo systemctl enable sshd
$	sudo systemctl start sshd
```

#### Config

next edit the ssh-server's config file:
```
$	sudo vim /etc/sshd_config
```

The following configurations will want to be added/changed:

Disable root login, and don't display last log on
```
PermitRootLogin no
PrintLastlog no
```

Specify which users can/can't use ssh
```
AllowUsers michael
DenyUsers guyinatuxedo
```

Specify the time limit that ssh will wait after being sent a request before disconnecting:
```
LoginGraceTine
```

Limit the number of concurrent ssh attempts, helps prevent brute forcing:

```
MaxStartups 2
```

Disable forwarding (helps prevent pivoting)
```
AllowTcpForwarding no
X11Forwarding no
```

Specify the log level (a lot of logs):
```
LogLevel VERBOSE
```

Disable authentication without passwords
```
PermitEmpytPasswords no
```

Specify an idle durration:

```
ClientAliveInterval 300
ClientAliveCountMax 0
```

### IPTables

These rules will allow for ingress and egress filtering, only ssh traffic will be allowed:
```
$	sudo iptables -P INPUT DROP
$	sudo iptables -P OUTPUT DROP
$	sudo iptables -P FORWARD DROP
$	sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT
$	sudo iptables -A OUTPUT -p tcp --sport 22 -j ACCEPT
```

for ip6, I just block everything:
```
$	sudo ip6tables -F
$	sudo ip6tables -P INPUT DROP
$	sudo ip6tables -P OUTPUT DROP
$	sudo ip6tables -P FORWARDUT DROP
```

save iptables rules, first install `iptables-persistent`:

```
$	sudo apt-get install iptables-persistent
```

then you can just generate the rule config files:
```
#	iptables-save > /etc/iptables/rules.v4
#	iptables-save > /etc/iptables/rules.v6
```

those files should look like this:
```
#	cat /etc/iptables/rules.v4
# Generated by iptables-save v1.6.1 on Thu Feb  1 00:54:02 2018
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [1:247]
-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport 22 -j ACCEPT
COMMIT
# Completed on Thu Feb  1 00:54:02 2018
#	cat /etc/iptables/rules.v6
# Generated by ip6tables-save v1.6.1 on Thu Feb  1 00:54:31 2018
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
COMMIT
# Completed on Thu Feb  1 00:54:31 2018
```
